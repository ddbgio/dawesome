#!/usr/bin/env bash

# https://docs.flutter.dev/get-started/install/linux/android
verify() {
    printf "🔍 Verifying $1 ... "
    which $1
    if [ $? -ne 0 ]; then
        echo "❌ $1 not installed."
        exit 1
    else
        echo "✅ $1 installed."
    fi
}

echo "🦋 Installing Flutter ..."

echo "Veryfying prerequisites ..."
verify bash
verify file
verify mkdir
verify rm
verify which

# update and install packages curl, git, unzip, xz-utils, zip, libglu1-mesa
echo "Updating and upgrading packages ..."
apt-get update -y && sudo apt-get upgrade -y;
if [ $? -ne 0 ]; then
    echo "❌ Failed to update and upgrade packages."
    exit 1
else
    echo "✅ Packages updated and upgraded."
fi

echo "Installing curl, git, unzip, xz-utils, zip, libglu1-mesa ..."
apt-get install -y curl git unzip xz-utils zip libglu1-mesa
if [ $? -ne 0 ]; then
    echo "❌ Failed to install curl, git, unzip, xz-utils, zip, libglu1-mesa."
    exit 1
else
    echo "✅ curl, git, unzip, xz-utils, zip, libglu1-mesa installed."
fi

#install prerequisites for Android Studio
apt-get install \
    libc6:amd64 libstdc++6:amd64 \
    libbz2-1.0:amd64 libncurses6:amd64
if [ $? -ne 0 ]; then
    echo "❌ Failed to install prerequisites for Android Studio."
    exit 1
else
    echo "✅ Prerequisites for Android Studio installed."
fi

echo "✅ $0 complete!"
